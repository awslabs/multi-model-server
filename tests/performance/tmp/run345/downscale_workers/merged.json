{
 "execution": [
  {
   "concurrency": 1,
   "ramp-up": "0s",
   "iterations": 1,
   "scenario": "Downscale"
  }
 ],
 "scenarios": {
  "Downscale": {
   "script": "downscale_workers.jmx"
  }
 },
 "services": [
  {
   "module": "shellexec",
   "prepare": [
    "bzt tests/common/setup.jmx tests/common/global_config.yaml -o settings.artifacts-dir=/tmp/mms_perf/"
   ],
   "post-process": [
    "bzt tests/common/teardown.jmx tests/common/global_config.yaml -o settings.artifacts-dir=/tmp/mms_perf/"
   ]
  },
  {
   "module": "server_local_monitoring",
   "ServerLocalClient": [
    {
     "interval": "1s",
     "metrics": [
      "total_workers"
     ]
    }
   ]
  }
 ],
 "modules": {
  "server_local_monitoring": {
   "class": "metrics_monitoring_taurus.Monitor"
  },
  "new_passfail": {
   "class": "new_passfail.PassFailStatus"
  },
  "jmeter": {
   "properties": {
    "hostname": "127.0.0.1",
    "port": 8080,
    "management_port": 8081,
    "protocol": "http",
    "input_filepath": "kitten.jpg"
   }
  }
 },
 "reporting": [
  {
   "module": "passfail",
   "criteria": [
    {
     "class": "bzt.modules.monitoring.MonitoringCriteria",
     "subject": "ServerLocalClient/total_workers",
     "condition": "<",
     "threshold": 2,
     "timeframe": "1s",
     "stop": true,
     "fail": true
    }
   ]
  },
  {
   "module": "passfail"
  },
  {
   "module": "junit-xml",
   "data-source": "pass-fail"
  },
  {
   "module": "junit-xml",
   "data-source": "sample-labels"
  },
  {
   "module": "final-stats",
   "dump-csv": "${BASEDIR}/final_stats.csv"
  }
 ],
 "settings": {
  "env": {
   "BASEDIR": "."
  }
 }
}
