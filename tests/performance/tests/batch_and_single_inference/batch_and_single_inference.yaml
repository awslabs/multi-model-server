---
scenarios:
  scenario_0:
    script: batch_and_single_inference.jmx


services:
  - module: shellexec
    prepare:
      - "curl -s -X POST http://localhost:8081/models?url=${RESNET_152_BATCH_URL}&batch_size=8&max_batch_delay=50"
      # uncomment below and comment prev and use downloaded model with model-store
      #- curl -s -X POST "http://localhost:8081/models?url=${RESNET_152_BATCH_NAME}.mar&batch_size=8&max_batch_delay=60&initial_workers=1"
      - "curl -s -X PUT  http://localhost:8081/models/${RESNET_152_BATCH_NAME}?min_worker=2&synchronous=true"
      - "curl -s -X POST http://localhost:8081/models?url=${SQZNET_URL}"
      - "curl -s -X PUT  http://localhost:8081/models/${SQZNET_NAME}?min_worker=2&synchronous=true"

reporting:
- module: passfail
  criteria:
    # Inbuilt Criteria
    - success of ManagementAPIDescription<${INF2_SUCC} for 10s, ${STOP_ALIAS} as failed
    - avg-rt of ManagementAPIDescription>${INF2_AVG_RT} for 10s, ${STOP_ALIAS} as failed